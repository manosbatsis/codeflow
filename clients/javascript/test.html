<HTML>
	<HEAD>
		<script src="jquery-3.3.1.min.js"></script>
	</HEAD>
	<BODY>
		<input type='button' value='Existing Flow' id='btnExisting'>
		<input type='button' value='New Flow' id='btnNew'>
	</BODY>
</HTML>
<script>

var users = [
	{'firstname':'Jimi', 'lastname':'Hendrix'},
	{'firstname':'Eric', 'lastname':'Clapton'},
	{'firstname':'Pete', 'lastname':'Townsend'},
	{'firstname':'Stevie Ray', 'lastname':'Vaughan'},
	{'firstname':'Rory', 'lastname':'Gallagher'},
	{'firstname':'Mark', 'lastname':'Knopfler'},
	{'firstname':'David', 'lastname':'Gilmour'},
	{'firstname':'Carlos', 'lastname':'Santana'},
	{'firstname':'Scotty', 'lastname':'Moore'},
	{'firstname':'Joe', 'lastname':'Walsh'},
];

var processId = 0;

var existingData = [
	{id:'start', pause:1000},
	{id:'save', pause:3000},
	{id:'end', pause:5000},
];

var newData = [
	{id:'start', pause:1000},
	{id:'create-record', pause:3000},
	{id:'save', pause:5000},
	{id:'end', pause:7000},
];

$(btnExisting).bind('click', function()	{
	doCalls(existingData, processId);
});

$(btnNew).bind('click', function()	{
	doCalls(newData, processId);
});

function doCalls(data, procid)	{

	var userIndex = parseInt(Math.random() * 10);
	processId++
	for (var i = 0; i < data.length; i++)	{
		callCodeflow(data[i], procid, userIndex);
	}

}

function callCodeflow(data, procid, userIndex)	{

	window.setTimeout(function()	{
		$.post( "http://localhost:8081", {
			diagramid:'customer-flow',
			stepid: data.id,
			action: 'enter',
			processid: procid,
			data: JSON.stringify(users[userIndex]) + ':'+ parseInt(Math.random() * 100000) + ' - ' + data.id,
			timestamp: new Date().getTime()
		});
	}, data.pause);

}
</script>
